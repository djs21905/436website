<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Analytics Systems Engineering Final Project</title>
    <meta name="description" content="Northwestern University Final Project Application">
    <meta name="author" content="Daniel Smith">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="https://kbroman.org/simple_site/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="https://kbroman.org/simple_site/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="https://kbroman.org/simple_site/assets/themes/twitter/css/kbroman.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->

    <!-- atom & rss feed -->
    <link href="https://kbroman.org/simple_sitenil" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="https://kbroman.org/simple_sitenil" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="https://kbroman.org/simple_site">Analytics Systems Engineering Final Project</a>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        

<div class="page-header">
  <h2>Craigslist Housing Application</h2>
</div>

<div class="row-fluid">
  <div class="span12">
    <p> The <a href="https://pypi.org/project/python-craigslist/">Python Craigslist API Wrapper</a> was used as the primary data source for this project.  The Data Pipeline
       uses batch processing to extract, transform and load Craigslist data from the Craigslist API.  An AWS Windows EC2 instance runs a python ETL script in 1 hour intervals. 
      This was achieved using Windows Task Manager event handling.  The extracted/transformed data is stored in tabular format using Google Sheets.  After considering
      several differen NoSQL and SQL data storage options the most cost and time efficient way to achieve the goal was with Google Sheets.  The ELK stack was also tested
      as a potential workflow but public sharing of Kibana visualizations was not possible. 
      <br>
      <br>
      Tableau was used for data visualization.  Dashboards generated in
      Tableau were subsequently saved to Tableau Public, enabling public access. Tableau has a built in connector for Google Sheets, making the importing and 
      maintenance of data intuitive and simple. Tableau Public also has an auto refresh feature for visualizations that are populated by Google Sheets data. Data
     is updated once per day automatically.  The initial goal of creating a fully automated data pipeline was achieved. 
      
<iframe src="https://drive.google.com/file/d/1inbZlWPTcV3wkVRs1zCmdZ7whovvbYwR/preview"  width="640" height="480"></iframe>
<p>For me, the painful aspects of making a website are</p>

<ul>
  <li>Working with html and css</li>
  <li>Finding a hosting site</li>
  <li>Transferring stuff to the hosting site</li>
</ul>

<p>With <a href="https://pages.github.com">GitHub Pages</a>, you just write things in
<a href="https://daringfireball.net/projects/markdown/">Markdown</a>,
<a href="https://github.com">GitHub</a> hosts the site for you, and you just push
material to your GitHub repository with <code class="language-plaintext highlighter-rouge">git add</code>, <code class="language-plaintext highlighter-rouge">git commit</code>, and
<code class="language-plaintext highlighter-rouge">git push</code>.</p>

<p>If you love <a href="https://git-scm.com/">git</a> and
<a href="https://github.com">GitHub</a>, you’ll love
<a href="https://pages.github.com">GitHub Pages</a>, too.</p>

<p>The sites use <a href="https://jekyllrb.com/">Jekyll</a>, a
<a href="https://www.ruby-lang.org/en/">ruby</a> <a href="https://rubygems.org/">gem</a>, to
convert Markdown files to html, and this part is done
automatically when you push the materials to the <code class="language-plaintext highlighter-rouge">gh-pages</code> branch
of a GitHub repository.</p>

<p>The <a href="https://pages.github.com">GitHub</a> and
<a href="https://jekyllrb.com">Jekyll</a> documentation is great, but I thought it
would be useful to have a minimal tutorial, for those who just want to
get going immediately with a simple site. To some readers, what GitHub
has might be simpler and more direct.  But if you just want to create
a site like the one you’re looking at now, read on.</p>

<p>Start by reading the <a href="pages/overview.html">Overview page</a>, which
explains the basic structure of these sites. Then read
<a href="pages/independent_site.html">how to make an independent website</a>. Then
read any of the other things, such as
<a href="pages/local_test.html">how to test your site locally</a>.</p>

<ul>
  <li><a href="pages/overview.html">Overview</a></li>
  <li><a href="pages/independent_site.html">Making an independent website</a></li>
  <li><a href="pages/user_site.html">Making a personal site</a></li>
  <li><a href="pages/project_site.html">Making a site for a project</a></li>
  <li><a href="pages/nojekyll.html">Making a jekyll-free site</a></li>
  <li><a href="pages/local_test.html">Testing your site locally</a></li>
  <li><a href="pages/resources.html">Resources</a></li>
</ul>
 <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #0000aa">import</span> <span style="color: #00aaaa; text-decoration: underline">pandas</span> <span style="color: #0000aa">as</span> <span style="color: #00aaaa; text-decoration: underline">pd</span>
<span style="color: #0000aa">import</span> <span style="color: #00aaaa; text-decoration: underline">numpy</span> <span style="color: #0000aa">as</span> <span style="color: #00aaaa; text-decoration: underline">np</span>
<span style="color: #0000aa">from</span> <span style="color: #00aaaa; text-decoration: underline">craigslist</span> <span style="color: #0000aa">import</span> CraigslistHousing
<span style="color: #0000aa">import</span> <span style="color: #00aaaa; text-decoration: underline">gspread</span> 
<span style="color: #0000aa">from</span> <span style="color: #00aaaa; text-decoration: underline">oauth2client.service_account</span> <span style="color: #0000aa">import</span> ServiceAccountCredentials
<span style="color: #0000aa">from</span> <span style="color: #00aaaa; text-decoration: underline">gspread_dataframe</span> <span style="color: #0000aa">import</span> get_as_dataframe, set_with_dataframe

scope = [<span style="color: #aa5500">&quot;https://spreadsheets.google.com/feeds&quot;</span>,<span style="color: #aa5500">&#39;https://www.googleapis.com/auth/spreadsheets&#39;</span>,
<span style="color: #aa5500">&quot;https://www.googleapis.com/auth/drive.file&quot;</span>,<span style="color: #aa5500">&quot;https://www.googleapis.com/auth/drive&quot;</span>]

creds = ServiceAccountCredentials.from_json_keyfile_name(<span style="color: #aa5500">&quot;creds.json&quot;</span>,scope)
gc= gspread.authorize(creds)
sheet = gc.open(<span style="color: #aa5500">&quot;436finalproject&quot;</span>).sheet1

cl = CraigslistHousing(site=<span style="color: #aa5500">&#39;chicago&#39;</span>, area=<span style="color: #aa5500">&#39;chc&#39;</span>, category=<span style="color: #aa5500">&#39;apa&#39;</span>)
results = cl.get_results(sort_by=<span style="color: #aa5500">&#39;price_asc&#39;</span>, geotagged=<span style="color: #00aaaa">True</span>, limit =<span style="color: #009999">100</span>)

df = {<span style="color: #aa5500">&#39;id&#39;</span>: [],
<span style="color: #aa5500">&#39;repost_of&#39;</span>: [],
<span style="color: #aa5500">&#39;name&#39;</span>: [],
<span style="color: #aa5500">&#39;url&#39;</span>: [],
<span style="color: #aa5500">&#39;datetime&#39;</span>: [],
<span style="color: #aa5500">&#39;last_updated&#39;</span>: [],
<span style="color: #aa5500">&#39;price&#39;</span>: [],
<span style="color: #aa5500">&#39;where&#39;</span>: [],
<span style="color: #aa5500">&#39;has_image&#39;</span>: [],
<span style="color: #aa5500">&#39;latitude&#39;</span>: [],
<span style="color: #aa5500">&#39;longitude&#39;</span>:[]}

<span style="color: #0000aa">for</span> result <span style="color: #0000aa">in</span> results:
    <span style="color: #0000aa">print</span>(result)
    df[<span style="color: #aa5500">&#39;id&#39;</span>].append(result[<span style="color: #aa5500">&#39;id&#39;</span>])
    df[<span style="color: #aa5500">&#39;repost_of&#39;</span>].append(result[<span style="color: #aa5500">&#39;repost_of&#39;</span>])
    df[<span style="color: #aa5500">&#39;name&#39;</span>].append(result[<span style="color: #aa5500">&#39;name&#39;</span>])
    df[<span style="color: #aa5500">&#39;url&#39;</span>].append(result[<span style="color: #aa5500">&#39;url&#39;</span>])
    df[<span style="color: #aa5500">&#39;datetime&#39;</span>].append(result[<span style="color: #aa5500">&#39;datetime&#39;</span>])
    df[<span style="color: #aa5500">&#39;last_updated&#39;</span>].append(result[<span style="color: #aa5500">&#39;last_updated&#39;</span>])
    df[<span style="color: #aa5500">&#39;price&#39;</span>].append(result[<span style="color: #aa5500">&#39;price&#39;</span>])
    df[<span style="color: #aa5500">&#39;where&#39;</span>].append(result[<span style="color: #aa5500">&#39;where&#39;</span>])
    
    df[<span style="color: #aa5500">&#39;has_image&#39;</span>].append(result[<span style="color: #aa5500">&#39;has_image&#39;</span>])
    <span style="color: #0000aa">if</span> result[<span style="color: #aa5500">&#39;geotag&#39;</span>] == <span style="color: #00aaaa">None</span>:
            df[<span style="color: #aa5500">&#39;latitude&#39;</span>].append(<span style="color: #009999">0.0</span>)
            df[<span style="color: #aa5500">&#39;longitude&#39;</span>].append(<span style="color: #009999">0.0</span>)
    <span style="color: #0000aa">else</span>:
        df[<span style="color: #aa5500">&#39;latitude&#39;</span>].append(result[<span style="color: #aa5500">&#39;geotag&#39;</span>][<span style="color: #009999">0</span>])
        df[<span style="color: #aa5500">&#39;longitude&#39;</span>].append(result[<span style="color: #aa5500">&#39;geotag&#39;</span>][<span style="color: #009999">1</span>])


b = pd.DataFrame(df)


a = get_as_dataframe(sheet)
a = a.iloc[:,<span style="color: #009999">0</span>:<span style="color: #009999">11</span>]
a.dropna(inplace=<span style="color: #00aaaa">True</span>)

final = pd.concat([a,b])
final[<span style="color: #aa5500">&#39;id&#39;</span>] = final[<span style="color: #aa5500">&#39;id&#39;</span>].astype(<span style="color: #aa5500">&#39;float&#39;</span>)
final.drop_duplicates(<span style="color: #aa5500">&#39;id&#39;</span>, inplace=<span style="color: #00aaaa">True</span>)
set_with_dataframe(sheet,final)
</pre></div>


<p>If anything here is confusing (or <em>wrong</em>!), or if I’ve missed
important details, please
<a href="https://github.com/kbroman/simple_site/issues">submit an issue</a>, or (even
better) fork <a href="https://github.com/kbroman/simple_site">the GitHub repository for this website</a>,
make modifications, and submit a pull request.</p>
    
<div class='tableauPlaceholder' id='viz1595338434094' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;sy&#47;synctest&#47;Sheet1&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='synctest&#47;Sheet1' /><param name='tabs' value='no' /><param name='toolbar' value='no' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;sy&#47;synctest&#47;Sheet1&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1595338434094');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>


<hr />

<p>The source for this minimal tutorial is <a href="https://github.com/kbroman/simple_site">on github</a>.</p>

<p>Also see my <a href="https://kbroman.org/pages/tutorials">tutorials</a> on
<a href="https://kbroman.org/github_tutorial">git/github</a>,
<a href="https://kbroman.org/minimal_make">GNU make</a>,
<a href="https://kbroman.org/knitr_knutshell">knitr</a>,
<a href="https://kbroman.org/pkg_primer">R packages</a>,
<a href="https://kbroman.org/dataorg">data organization</a>,
and <a href="https://kbroman.org/steps2rr">reproducible research</a>.</p>

  </div>
</div>


      </div>
      <hr>
      <footer>
        <p><small>
  <!-- start of Karl's footer; modify this part -->
          <a href="https://creativecommons.org/publicdomain/zero/1.0/"><img src="https://i.creativecommons.org/p/zero/1.0/88x31.png" alt="CC0"/></a> &nbsp;
          <a href="https://kbroman.org">Karl Broman</a>
  <!-- end of Karl's footer; modify this part -->
        </small></p>
      </footer>

    </div>

  </body>
</html>



